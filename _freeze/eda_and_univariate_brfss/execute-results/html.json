{
  "hash": "690d4a19b3fa514aa8c50ec89e3fea31",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Case Study: Behavioral Risk Factor Surveillance System\"\n---\n\n\n<!-- Thanks to Martin Morgan for much of this material! -->\n\n\n\n## A Case Study on the Behavioral Risk Factor Surveillance System\n\nThe Behavioral Risk Factor Surveillance System (BRFSS) is a large-scale health\nsurvey conducted annually by the Centers for Disease Control and Prevention\n(CDC) in the United States. The BRFSS collects information on various\nhealth-related behaviors, chronic health conditions, and the use of preventive\nservices among the adult population (18 years and older) through telephone\ninterviews. The main goal of the BRFSS is to identify and monitor the\nprevalence of risk factors associated with chronic diseases, inform public\nhealth policies, and evaluate the effectiveness of health promotion and disease\nprevention programs. The data collected through BRFSS is crucial for\nunderstanding the health status and needs of the population, and it serves as a\nvaluable resource for researchers, policy makers, and healthcare professionals\nin making informed decisions and designing targeted interventions.\n \nIn this chapter, we will walk through an exploratory data analysis (EDA) of the\nBehavioral Risk Factor Surveillance System dataset using R. EDA is an important\nstep in the data analysis process, as it helps you to understand your data,\nidentify trends, and detect any anomalies before performing more advanced\nanalyses. We will use various R functions and packages to explore the dataset,\nwith a focus on active learning and hands-on experience.\n\n## Loading the Dataset\n \nFirst, let's load the dataset into R. We will use the read.csv() function from\nthe base R package to read the data and store it in a data frame called brfss.\nMake sure the CSV file is in your working directory, or provide the full path\nto the file.\n\nFirst, we need to get the data. Either download the data\nfrom [THIS LINK](data/BRFSS-subset.csv) or have R do it directly from the\ncommand-line (preferred):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndownload.file('https://raw.githubusercontent.com/seandavi/ITR/master/BRFSS-subset.csv',\n              destfile = 'BRFSS-subset.csv')\n```\n:::\n\n\n\n<!--\n\n::: {.cell}\n\n:::\n\n-->\n\n::: {.cell}\n\n```{.r .cell-code}\npath <- file.choose()    # look for BRFSS-subset.csv\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstopifnot(file.exists(path))\nbrfss <- read.csv(path)\n```\n:::\n\n\n\n\n## Inspecting the Data\n \nOnce the data is loaded, let's take a look at the first few rows of the dataset\nusing the `head()` function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(brfss)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Age   Weight    Sex Height Year\n1  31 48.98798 Female 157.48 1990\n2  57 81.64663 Female 157.48 1990\n3  43 80.28585   Male 177.80 1990\n4  72 70.30682   Male 170.18 1990\n5  31 49.89516 Female 154.94 1990\n6  58 54.43108 Female 154.94 1990\n```\n\n\n:::\n:::\n\n \nThis will display the first six rows of the dataset, allowing you to get a feel\nfor the data structure and variable types.\n\nNext, let's check the dimensions of the dataset using the `dim()` function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(brfss)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 20000     5\n```\n\n\n:::\n:::\n\n \nThis will return the number of rows and columns in the dataset, which is\nimportant to know for subsequent analyses.\n\n## Summary Statistics\n \nNow that we have a basic understanding of the data structure, let's calculate\nsome summary statistics. The `summary()` function in R provides a quick overview\nof the main statistics for each variable in the dataset:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(brfss)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age            Weight           Sex                Height     \n Min.   :18.00   Min.   : 34.93   Length:20000       Min.   :105.0  \n 1st Qu.:36.00   1st Qu.: 61.69   Class :character   1st Qu.:162.6  \n Median :51.00   Median : 72.57   Mode  :character   Median :168.0  \n Mean   :50.99   Mean   : 75.42                      Mean   :169.2  \n 3rd Qu.:65.00   3rd Qu.: 86.18                      3rd Qu.:177.8  \n Max.   :99.00   Max.   :278.96                      Max.   :218.0  \n NA's   :139     NA's   :649                         NA's   :184    \n      Year     \n Min.   :1990  \n 1st Qu.:1990  \n Median :2000  \n Mean   :2000  \n 3rd Qu.:2010  \n Max.   :2010  \n               \n```\n\n\n:::\n:::\n\n\nThis will display the minimum, first quartile, median, mean, third quartile,\nand maximum for each numeric variable, and the frequency counts for each factor\nlevel for categorical variables.\n\n## Data Visualization\n \nVisualizing the data can help you identify patterns and trends in the dataset.\nLet's start by creating a histogram of the Age variable using the `hist()`\nfunction.\n\nThis will create a histogram showing the frequency distribution of ages in the\ndataset. You can customize the appearance of the histogram by adjusting the\nparameters within the `hist()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(brfss$Age, main = \"Age Distribution\", \n     xlab = \"Age\", col = \"lightblue\")\n```\n\n::: {.cell-output-display}\n![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-tip}\n## What are the options for a histogram?\n\nThe `hist()` function has many options.  For example, you can change the number\nof bins, the color of the bars, the title, and the x-axis label.  You can also\nadd a vertical line at the mean or median, or add a normal curve to the\nhistogram.  For more information, type `?hist` in the R console.\n\nMore generally, it is important to understand the options available for each\nfunction you use.  You can do this by reading the documentation for the\nfunction, which can be accessed by typing `?function_name` or\n`help(\"function_name\")`in the R console.\n:::\n\n\nNext, let's create a boxplot to compare the distribution of Weight between\nmales and females. We will use the `boxplot()` function for this. This will\ncreate a boxplot comparing the weight distribution between males and females.\nYou can customize the appearance of the boxplot by adjusting the parameters\nwithin the `boxplot()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(brfss$Weight ~ brfss$Sex, main = \"Weight Distribution by Sex\", \n        xlab = \"Sex\", ylab = \"Weight\", col = c(\"pink\", \"lightblue\"))  \n```\n\n::: {.cell-output-display}\n![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Analyzing Relationships Between Variables\n \nTo further explore the data, let's investigate the relationship between age and\nweight using a scatterplot. We will use the plot() function for this:\n\nThis will create a scatterplot of age and weight, allowing you to visually\nassess the relationship between these two variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(brfss$Age, brfss$Weight, main = \"Scatterplot of Age and Weight\", \n     xlab = \"Age\", ylab = \"Weight\", col = \"darkblue\")  \n```\n\n::: {.cell-output-display}\n![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nTo quantify the strength of the relationship between age and weight, we can calculate the correlation coefficient using the cor() function:\n\nThis will return the correlation coefficient between age and weight, which can help you determine whether there is a linear relationship between these variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(brfss$Age, brfss$Weight)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA\n```\n\n\n:::\n:::\n\n\nWhy does `cor()` give a value of `NA`?  What can we do about it? A quick glance at `help(\"cor\")` will give you the answer.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(brfss$Age, brfss$Weight, use = \"complete.obs\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.02699989\n```\n\n\n:::\n:::\n\n\n## Exercises\n\n1.  What is the mean weight in this dataset?  How about the median?  What is the\n    difference between the two?  What does this tell you about the distribution\n    of weights in the dataset?\n    \n\n    ::: {.cell}\n    \n    ```{.r .cell-code  code-fold=\"true\" code-summary=\"Show answer\"}\n    mean(brfss$Weight, na.rm = TRUE)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 75.42455\n    ```\n    \n    \n    :::\n    \n    ```{.r .cell-code  code-fold=\"true\" code-summary=\"Show answer\"}\n    median(brfss$Weight, na.rm = TRUE)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 72.57478\n    ```\n    \n    \n    :::\n    \n    ```{.r .cell-code  code-fold=\"true\" code-summary=\"Show answer\"}\n    mean(brfss$Weight, na.rm=TRUE) - median(brfss$Weight, na.rm = TRUE)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 2.849774\n    ```\n    \n    \n    :::\n    :::\n\n\n2.  Given the findings about the `mean` and `median` in the previous exercise,\n    use the `hist()` function to create a histogram of the weight distribution\n    in this dataset.  How would you describe the shape of this distribution?\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code  code-fold=\"true\" code-summary=\"Show answer\"}\n    hist(brfss$Weight, xlab=\"Weight (kg)\", breaks = 30)\n    ```\n    \n    ::: {.cell-output-display}\n    ![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-12-1.png){width=672}\n    :::\n    :::\n\n\n\n2.  Use `plot()` to examine the relationship between height and weight in this dataset.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code  code-fold=\"true\" code-summary=\"Show answer\"}\n    plot(brfss$Height, brfss$Weight)\n    ```\n    \n    ::: {.cell-output-display}\n    ![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-13-1.png){width=672}\n    :::\n    :::\n\n\n3.  What is the correlation between height and weight?  What does this tell you about the relationship between these two variables?\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code  code-fold=\"true\" code-summary=\"Show answer\"}\n    cor(brfss$Height, brfss$Weight, use = \"complete.obs\")\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.5140928\n    ```\n    \n    \n    :::\n    :::\n\n\n4.  Create a histogram of the height distribution in this dataset. How would you describe the shape of this distribution?\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code  code-fold=\"true\" code-summary=\"Show answer\"}\n    hist(brfss$Height, xlab=\"Height (cm)\", breaks = 30)\n    ```\n    \n    ::: {.cell-output-display}\n    ![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-15-1.png){width=672}\n    :::\n    :::\n\n\n## Conclusion\n \nIn this chapter, we have demonstrated how to perform an exploratory data analysis on the Behavioral Risk Factor Surveillance System dataset using R. We covered data loading, inspection, summary statistics, visualization, and the analysis of relationships between variables. By actively engaging with the R code and data, you have gained valuable experience in using R for EDA and are well-equipped to tackle more complex analyses in your future work.\n\nRemember that EDA is just the beginning of the data analysis process, and further statistical modeling and hypothesis testing will likely be necessary to draw meaningful conclusions from your data. However, EDA is a crucial step in understanding your data and informing your subsequent analyses.\n\n\n## Learn about the data\n\nUsing the data exploration techniques you have seen to explore the brfss dataset.\n\n- summary()\n- dim()\n- colnames()\n- head()\n- tail()\n- class()\n- View()\n\nYou may want to investigate individual columns visually using plotting like `hist()`. For categorical \ndata, consider using something like `table()`. \n\n## Clean data\n\n_R_ read `Year` as an integer value, but it's really a `factor`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrfss$Year <- factor(brfss$Year)\n```\n:::\n\n\n## Weight in 1990 vs. 2010 Females\n\n- Create a subset of the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrfssFemale <- brfss[brfss$Sex == \"Female\",]\nsummary(brfssFemale)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age            Weight           Sex                Height     \n Min.   :18.00   Min.   : 36.29   Length:12039       Min.   :105.0  \n 1st Qu.:37.00   1st Qu.: 57.61   Class :character   1st Qu.:157.5  \n Median :52.00   Median : 65.77   Mode  :character   Median :163.0  \n Mean   :51.92   Mean   : 69.05                      Mean   :163.3  \n 3rd Qu.:67.00   3rd Qu.: 77.11                      3rd Qu.:168.0  \n Max.   :99.00   Max.   :272.16                      Max.   :200.7  \n NA's   :103     NA's   :560                         NA's   :140    \n   Year     \n 1990:5718  \n 2010:6321  \n            \n            \n            \n            \n            \n```\n\n\n:::\n:::\n\n\n- Visualize\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(Weight ~ Year, brfssFemale)\n```\n\n::: {.cell-output-display}\n![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n- Statistical test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(Weight ~ Year, brfssFemale)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  Weight by Year\nt = -27.133, df = 11079, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group 1990 and group 2010 is not equal to 0\n95 percent confidence interval:\n -8.723607 -7.548102\nsample estimates:\nmean in group 1990 mean in group 2010 \n          64.81838           72.95424 \n```\n\n\n:::\n:::\n\n\n## Weight and height in 2010 Males\n\n- Create a subset of the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrfss2010Male <- subset(brfss,  Year == 2010 & Sex == \"Male\")\nsummary(brfss2010Male)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age            Weight           Sex                Height      Year     \n Min.   :18.00   Min.   : 36.29   Length:3679        Min.   :135   1990:   0  \n 1st Qu.:45.00   1st Qu.: 77.11   Class :character   1st Qu.:173   2010:3679  \n Median :57.00   Median : 86.18   Mode  :character   Median :178              \n Mean   :56.25   Mean   : 88.85                      Mean   :178              \n 3rd Qu.:68.00   3rd Qu.: 99.79                      3rd Qu.:183              \n Max.   :99.00   Max.   :278.96                      Max.   :218              \n NA's   :30      NA's   :49                          NA's   :31               \n```\n\n\n:::\n:::\n\n\n- Visualize the relationship\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(brfss2010Male$Weight)\n```\n\n::: {.cell-output-display}\n![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(brfss2010Male$Height)\n```\n\n::: {.cell-output-display}\n![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-21-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(Weight ~ Height, brfss2010Male)\n```\n\n::: {.cell-output-display}\n![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-21-3.png){width=672}\n:::\n:::\n\n\n- Fit a linear model (regression)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- lm(Weight ~ Height, brfss2010Male)\nfit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Weight ~ Height, data = brfss2010Male)\n\nCoefficients:\n(Intercept)       Height  \n   -86.8747       0.9873  \n```\n\n\n:::\n:::\n\n\nSummarize as ANOVA table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: Weight\n            Df  Sum Sq Mean Sq F value    Pr(>F)    \nHeight       1  197664  197664   693.8 < 2.2e-16 ***\nResiduals 3617 1030484     285                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n- Plot points, superpose fitted regression line; where am I?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(Weight ~ Height, brfss2010Male)\nabline(fit, col=\"blue\", lwd=2)\n# Substitute your own weight and height...\npoints(73 * 2.54, 178 / 2.2, col=\"red\", cex=4, pch=20)\n```\n\n::: {.cell-output-display}\n![](eda_and_univariate_brfss_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n- Class and available 'methods'\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(fit)                 # 'noun'\nmethods(class=class(fit))  # 'verb'\n```\n:::\n\n\n- Diagnostics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(fit)\n# Note that the \"plot\" above does not have a \".lm\"\n# However, R will use \"plot.lm\". Why?\n?plot.lm\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}